<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function selects the best covariance structure for genetic correlations
between trials. It fits a range of variance-covariance models (identity,
compound symmetry (cs), diagonal, simple correlation with heterogeneous
variance (outside), heterogeneous compound symmetry (hcs),
first order factor analytic (fa), second order factor analytic (fa2) and
unstructured), and selects the best one using a goodness-of-fit criterion.
See details for the exact models fitted."><title>Selects the best variance-covariance model for a set of trials — gxeVarCov • statgenGxE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Selects the best variance-covariance model for a set of trials — gxeVarCov"><meta property="og:description" content="This function selects the best covariance structure for genetic correlations
between trials. It fits a range of variance-covariance models (identity,
compound symmetry (cs), diagonal, simple correlation with heterogeneous
variance (outside), heterogeneous compound symmetry (hcs),
first order factor analytic (fa), second order factor analytic (fa2) and
unstructured), and selects the best one using a goodness-of-fit criterion.
See details for the exact models fitted."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">statgenGxE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--other-packages">
    <span class="fa fa-seedling"></span>
     
    other packages
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--other-packages">
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenHTP">statgenHTP</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenQTLxT">statgenQTLxT</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Biometris/statgenGxE">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Selects the best variance-covariance model for a set of trials</h1>
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenGxE/blob/HEAD/R/gxeVarCov.R" class="external-link"><code>R/gxeVarCov.R</code></a></small>
      <div class="d-none name"><code>gxeVarCov.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function selects the best covariance structure for genetic correlations
between trials. It fits a range of variance-covariance models (identity,
compound symmetry (cs), diagonal, simple correlation with heterogeneous
variance (outside), heterogeneous compound symmetry (hcs),
first order factor analytic (fa), second order factor analytic (fa2) and
unstructured), and selects the best one using a goodness-of-fit criterion.
See details for the exact models fitted.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gxeVarCov</span><span class="op">(</span></span>
<span>  <span class="va">TD</span>,</span>
<span>  trials <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TD</span><span class="op">)</span>,</span>
<span>  <span class="va">trait</span>,</span>
<span>  models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"identity"</span>, <span class="st">"cs"</span>, <span class="st">"diagonal"</span>, <span class="st">"hcs"</span>, <span class="st">"outside"</span>, <span class="st">"fa"</span>, <span class="st">"fa2"</span>, <span class="st">"unstructured"</span><span class="op">)</span>,</span>
<span>  engine <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lme4"</span>, <span class="st">"asreml"</span><span class="op">)</span>,</span>
<span>  criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BIC"</span>, <span class="st">"AIC"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>TD</dt>
<dd><p>An object of class <code>TD</code>.</p></dd>


<dt>trials</dt>
<dd><p>A character string specifying the trials to be analyzed. If
not supplied, all trials are used in the analysis.</p></dd>


<dt>trait</dt>
<dd><p>A character string specifying the trait to be analyzed.</p></dd>


<dt>models</dt>
<dd><p>A character vector specifying the models to be fitted.</p></dd>


<dt>engine</dt>
<dd><p>A character string specifying the engine used for modeling.
Either "lme4" or "asreml".</p></dd>


<dt>criterion</dt>
<dd><p>A string specifying a goodness-of-fit criterion. Either
"AIC" or "BIC".</p></dd>


<dt>...</dt>
<dd><p>Further arguments to be passed to the modeling engine.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code><a href="varCov.html">varCov</a></code>, a list object containing:</p>
<dl><dt>STA</dt>
<dd><p>An object of class STA containing the best fitted model.</p></dd>

<dt>choice</dt>
<dd><p>A character string indicating the best fitted model.</p></dd>

<dt>summary</dt>
<dd><p>A data.frame with a summary of the fitted models.</p></dd>

<dt>vcov</dt>
<dd><p>The covariance matrix of the best fitted model.</p></dd>

<dt>criterion</dt>
<dd><p>A character string indicating the goodness-of-fit criterion
used for determining the best model, either "AIC" or "BIC".</p></dd>

<dt>engine</dt>
<dd><p>A character string containing the engine used for
the analysis.</p></dd>

<dt>trait</dt>
<dd><p>A character string containing the trait analyzed.</p></dd>

<dt>dat</dt>
<dd><p>A data.frame with the full data set used for the analysis.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The models fitted are of the form \(y_{ij} = \mu_j + \epsilon_{ij}\), where
\(y_{ij}\) is the phenotypic value of genotype \(i\) in environment
\(j\), \(\mu_j\)
is the environmental mean, and \(\epsilon_{ij}\) represents mainly genetic
variation, although some non-genetic variation may be included as well.
The random term \(\epsilon_{ij}\) is modeled in eight ways as described in
the table below.</p><table class="table table"><tr><td>Model</td><td>Description</td><td>var(\(g_{ij}\))</td><td>cov(\(g_{ij}\);\(g_{ik}\))</td><td>Number of parameters</td></tr><tr><td>identity</td><td>identity</td><td>\(\sigma_G^2\)</td><td>0</td><td>1</td></tr><tr><td>cs</td><td>compound symmetry</td><td>\(\sigma_G^2+\sigma_{GE}^2\)</td><td>\(\sigma_{GE}^2\)</td><td>2</td></tr><tr><td>diagonal</td><td>diagonal matrix (heteroscedastic)</td><td>\(\sigma_{GE_j}^2\)</td><td>0</td><td>\(J\)</td></tr><tr><td>hcs</td><td>heterogeneous compound symmetry</td><td>\(\sigma_G^2+\sigma_{GE_j}^2\)</td><td>\(\sigma_G^2\)</td><td>\(J+1\)</td></tr><tr><td>outside</td><td>heterogeneity outside</td><td>\(\sigma_{G_j}^2\)</td><td>\(\theta\)</td><td>\(J+1\)</td></tr><tr><td>fa</td><td>first order factor analytic</td><td>\(\lambda_{1j}^2+\sigma_{GE_j}^2\)</td><td>\(\lambda_{1j}\lambda_{1k}\)</td><td>\(2J\)</td></tr><tr><td>fa2</td><td>second order factor analytic</td><td>\(\lambda_{1j}^2+\lambda_{2j}^2+\sigma_{GE_j}^2\)</td><td>\(\lambda_{1j}\lambda_{1k}+\lambda_{2j}\lambda_{2k}\)</td><td>\(3J-1\)</td></tr><tr><td>unstructured</td><td>unstructured</td><td>\(\sigma_{G_j}^2\)</td><td>\(\sigma_{G_{j,k}}^2\)</td><td>\(J(J+1)/2\)</td></tr></table><p>In this table \(J\) is the number of environments, \(\sigma_G^2\) the
variance component for the genotype main effects, \(\sigma_{GE}^2\) the
variance component for GxE interactions. \(\sigma_{G_j}^2\) and
\(\sigma_{GE_j}^2\) are the environment specific variance components for
the genotype main effects and GxE interaction in environment \(j\).
\(\sigma_{G_{j,k}}^2\) is the genetic covariance between environments
\(j\) and \(k\). \(\theta\) is the common correlation between
environments and \(\lambda_{1j}\) and \(\lambda_{2j}\) are
environment specific multiplicative parameters.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If <code>engine = "lme4"</code>, only the compound symmetry model can be
fitted.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other varCov: 
<code><a href="fitted.varCov.html">fitted.varCov</a>()</code>,
<code><a href="plot.varCov.html">plot.varCov</a>()</code>,
<code><a href="report.varCov.html">report.varCov</a>()</code>,
<code><a href="residuals.varCov.html">residuals.varCov</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Select the best variance-covariance model using lme4 for modeling.</span></span></span>
<span class="r-in"><span><span class="va">geVarCov</span> <span class="op">&lt;-</span> <span class="fu">gxeVarCov</span><span class="op">(</span>TD <span class="op">=</span> <span class="va">TDMaize</span>, trait <span class="op">=</span> <span class="st">"yld"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Summarize results.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">geVarCov</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best model: cs, based on BIC.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         AIC      BIC Deviance NParameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cs 21005.28 21016.14 21001.28           2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Create a pdf report summarizing the results.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/statgenSTA/man/report.html" class="external-link">report</a></span><span class="op">(</span><span class="va">geVarCov</span>, outfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".pdf"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in report.varCov(geVarCov, outfile = tempfile(fileext = ".pdf")):</span> An installation of LaTeX is required to create a pdf report.</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"asreml"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co">## Select the best variance-covariance model using asreml for modeling.</span></span></span>
<span class="r-in"><span>  <span class="co">## Use BIC as a goodness-of-fit criterion.</span></span></span>
<span class="r-in"><span>  <span class="va">geVarCov2</span> <span class="op">&lt;-</span> <span class="fu">gxeVarCov</span><span class="op">(</span>TD <span class="op">=</span> <span class="va">TDMaize</span>, trait <span class="op">=</span> <span class="st">"yld"</span>, engine <span class="op">=</span> <span class="st">"asreml"</span>,</span></span>
<span class="r-in"><span>                         criterion <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">geVarCov2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## Plot a heatmap of the correlation matrix for the best model.</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">geVarCov2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

