<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot function for class AMMI — plot.AMMI • statgenGxE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot function for class AMMI — plot.AMMI"><meta name="description" content="Two types of biplot can be made. A plot of genotype and environment
means vs PC1 (AMMI1) or a biplot of genotypes and environment interaction
with PC1 and PC2 (AMMI2).
If the AMMI analysis was done by year, a separate plot will be made for
every year in the data. For some years the number of principal components
may be lower than the number specified on the secondary axis. If this is the
case this year is skipped when plotting. If this happens for all years the
function returns an error."><meta property="og:description" content="Two types of biplot can be made. A plot of genotype and environment
means vs PC1 (AMMI1) or a biplot of genotypes and environment interaction
with PC1 and PC2 (AMMI2).
If the AMMI analysis was done by year, a separate plot will be made for
every year in the data. For some years the number of principal components
may be lower than the number specified on the secondary axis. If this is the
case this year is skipped when plotting. If this happens for all years the
function returns an error."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">statgenGxE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> news</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-seedling"></span> other packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenSTA">statgenSTA</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenHTP">statgenHTP</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenQTLxT">statgenQTLxT</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Biometris/statgenGxE"><span class="fa fa-github fa-lg"></span> github</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot function for class AMMI</h1>
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenGxE/blob/main/R/createAMMI.R" class="external-link"><code>R/createAMMI.R</code></a></small>
      <div class="d-none name"><code>plot.AMMI.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Two types of biplot can be made. A plot of genotype and environment
means vs PC1 (AMMI1) or a biplot of genotypes and environment interaction
with PC1 and PC2 (AMMI2).<br><br>
If the AMMI analysis was done by year, a separate plot will be made for
every year in the data. For some years the number of principal components
may be lower than the number specified on the secondary axis. If this is the
case this year is skipped when plotting. If this happens for all years the
function returns an error.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'AMMI'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  plotType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AMMI1"</span>, <span class="st">"AMMI2"</span>, <span class="st">"GGE2"</span><span class="op">)</span>,</span>
<span>  scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  plotGeno <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  colorGenoBy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colGeno <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sizeGeno <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  plotConvHull <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plotEnv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  colorEnvBy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colEnv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sizeEnv <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  envFactor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  primAxis <span class="op">=</span> <span class="st">"PC1"</span>,</span>
<span>  secAxis <span class="op">=</span> <span class="st">"PC2"</span>,</span>
<span>  rotatePC <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class AMMI</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Not used.</p></dd>


<dt id="arg-plottype">plotType<a class="anchor" aria-label="anchor" href="#arg-plottype"></a></dt>
<dd><p>A character string indicating which plot should be made.
Either "AMMI1" for an AMMI1 plot (genotype and
environment means vs PC1) or "AMMI2" for an AMMI2 biplot (genotypes and
environment interaction with PC1 and PC2) respectively. For results of a
GGE analysis only an GGE2 biplot can be made and plotType may be ignored.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>A numerical value. The variables are scaled by
<code>lambda ^ scale</code> and the observations by <code>lambda ^ (1 - scale)</code>
where <code>lambda</code> are the singular values computed by
<code><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></code> in <code><a href="gxeAmmi.html">gxeAmmi</a></code>. Normally
<code>0 &lt;= scale &lt;= 1</code>, and a warning will be issued if the specified
scale is outside this range.</p></dd>


<dt id="arg-plotgeno">plotGeno<a class="anchor" aria-label="anchor" href="#arg-plotgeno"></a></dt>
<dd><p>Should genotypes be plotted?</p></dd>


<dt id="arg-colorgenoby">colorGenoBy<a class="anchor" aria-label="anchor" href="#arg-colorgenoby"></a></dt>
<dd><p>A character string indicating a column in the <code>TD</code>
used as input for the AMMI analysis by which the genotypes should be colored.
If <code>NULL</code> all genotypes will be colored in black.</p></dd>


<dt id="arg-colgeno">colGeno<a class="anchor" aria-label="anchor" href="#arg-colgeno"></a></dt>
<dd><p>A character vector with plot colors for the genotypes. A
single color when <code>colorGenoBy = NULL</code>, a vector of colors otherwise.</p></dd>


<dt id="arg-sizegeno">sizeGeno<a class="anchor" aria-label="anchor" href="#arg-sizegeno"></a></dt>
<dd><p>An numerical value indicating the text size for plotting the
genotypes. Use <code>sizeGeno = 0</code> for plotting genotypes as points instead
of using their names.</p></dd>


<dt id="arg-plotconvhull">plotConvHull<a class="anchor" aria-label="anchor" href="#arg-plotconvhull"></a></dt>
<dd><p>Should a convex hull be plotted around the genotypes. If
<code>TRUE</code> a convex hull is plotted. For GGE2 biplots lines from the origin
of the plot perpendicular to the edges of the hull are added. Only valid for
AMMI2 and GGE2 biplots.</p></dd>


<dt id="arg-plotenv">plotEnv<a class="anchor" aria-label="anchor" href="#arg-plotenv"></a></dt>
<dd><p>Should environments be plotted?</p></dd>


<dt id="arg-colorenvby">colorEnvBy<a class="anchor" aria-label="anchor" href="#arg-colorenvby"></a></dt>
<dd><p>A character string indicating a column in the <code>TD</code>
used as input for the AMMI analysis by which the environments should be
colored. If <code>NULL</code> all genotypes will be colored in red.</p></dd>


<dt id="arg-colenv">colEnv<a class="anchor" aria-label="anchor" href="#arg-colenv"></a></dt>
<dd><p>A character string with plot colors for the environments. A
single color when <code>colorEnvBy = NULL</code>, a vector of colors otherwise.</p></dd>


<dt id="arg-sizeenv">sizeEnv<a class="anchor" aria-label="anchor" href="#arg-sizeenv"></a></dt>
<dd><p>An integer indicating the text size for plotting the
environments.</p></dd>


<dt id="arg-envfactor">envFactor<a class="anchor" aria-label="anchor" href="#arg-envfactor"></a></dt>
<dd><p>A positive numerical value giving a factor by which to blow
up the environmental scores. Providing a value between 0 and 1 will
effectively blow up the genotypic scores.</p></dd>


<dt id="arg-primaxis">primAxis<a class="anchor" aria-label="anchor" href="#arg-primaxis"></a></dt>
<dd><p>A character string indicating the principal component to be
plotted on the primary axis of the AMMI2 plot. Has to be given as
<code>"PCn"</code> where n is the number of the principal component.</p></dd>


<dt id="arg-secaxis">secAxis<a class="anchor" aria-label="anchor" href="#arg-secaxis"></a></dt>
<dd><p>A character string indicating the principal component to be
plotted on the secondary axis of the AMMI2 plot. Has to be given as
<code>"PCn"</code> where n is the number of the principal component. n Has to
differ from <code>primAxis</code>.</p></dd>


<dt id="arg-rotatepc">rotatePC<a class="anchor" aria-label="anchor" href="#arg-rotatepc"></a></dt>
<dd><p>A character string indicating a genotype or environment that
is to be aligned with the positive x-axis in the plot.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>A character string used a title for the plot.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>Should the plot be output to the current device? If
<code>FALSE</code> only a list of ggplot objects is invisibly returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A biplot depending on <code>plotType</code>. The ggplot object for the
biplot is returned invisibly.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other AMMI:
<code><a href="fitted.AMMI.html">fitted.AMMI</a>()</code>,
<code><a href="gxeAmmi.html">gxeAmmi</a>()</code>,
<code><a href="report.AMMI.html">report.AMMI</a>()</code>,
<code><a href="residuals.AMMI.html">residuals.AMMI</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Run AMMI analysis.</span></span></span>
<span class="r-in"><span><span class="va">geAmmi</span> <span class="op">&lt;-</span> <span class="fu"><a href="gxeAmmi.html">gxeAmmi</a></span><span class="op">(</span>TD <span class="op">=</span> <span class="va">TDMaize</span>, trait <span class="op">=</span> <span class="st">"yld"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create an AMMI1 biplot.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">geAmmi</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.AMMI-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create an AMMI2 biplot.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">geAmmi</span>, plotType <span class="op">=</span> <span class="st">"AMMI2"</span>, scale <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.AMMI-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create an AMMI2 biplot, with HN96b along the positive x-axis.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">geAmmi</span>, plotType <span class="op">=</span> <span class="st">"AMMI2"</span>, scale <span class="op">=</span> <span class="fl">0.5</span>, rotatePC <span class="op">=</span> <span class="st">"HN96b"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.AMMI-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Run GGE analysis.</span></span></span>
<span class="r-in"><span><span class="va">geGGE</span> <span class="op">&lt;-</span> <span class="fu"><a href="gxeGGE.html">gxeGGE</a></span><span class="op">(</span>TD <span class="op">=</span> <span class="va">TDMaize</span>, trait <span class="op">=</span> <span class="st">"yld"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create an GGE2 biplot.</span></span></span>
<span class="r-in"><span><span class="co">## Add a convex hull.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">geGGE</span>, plotType <span class="op">=</span> <span class="st">"GGE2"</span>, scale <span class="op">=</span> <span class="fl">0.5</span>, plotConvHull <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.AMMI-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

