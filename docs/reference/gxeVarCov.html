<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Selects the best variance-covariance model for a set of trials — gxeVarCov • statgenGxE</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Selects the best variance-covariance model for a set of trials — gxeVarCov" />
<meta property="og:description" content="This function selects the best covariance structure for genetic correlations
between trials. It fits a range of variance-covariance models (identity,
compound symmetry (cs), diagonal, simple correlation with heterogeneous
variance (outside), heterogeneous compound symmetry (hcs),
first order factor analytic (fa), second order factor analytic (fa2) and
unstructured), and selects the best one using a goodness-of-fit criterion.
See details for the exact models fitted." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statgenGxE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-seedling"></span>
     
    other packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    </li>
    <li>
      <a href="https://biometris.github.io/statgenGWAS">statgenGWAS</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/Biometris/statgenGxE">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Selects the best variance-covariance model for a set of trials</h1>
    <small class="dont-index">Source: <a href='https://github.com/Biometris/statgenGxE/blob/master/R/gxeVarCov.R'><code>R/gxeVarCov.R</code></a></small>
    <div class="hidden name"><code>gxeVarCov.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function selects the best covariance structure for genetic correlations
between trials. It fits a range of variance-covariance models (identity,
compound symmetry (cs), diagonal, simple correlation with heterogeneous
variance (outside), heterogeneous compound symmetry (hcs),
first order factor analytic (fa), second order factor analytic (fa2) and
unstructured), and selects the best one using a goodness-of-fit criterion.
See details for the exact models fitted.</p>
    </div>

    <pre class="usage"><span class='fu'>gxeVarCov</span><span class='op'>(</span>
  <span class='va'>TD</span>,
  trials <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>TD</span><span class='op'>)</span>,
  <span class='va'>trait</span>,
  engine <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"lme4"</span>, <span class='st'>"asreml"</span><span class='op'>)</span>,
  criterion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"BIC"</span>, <span class='st'>"AIC"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>TD</th>
      <td><p>An object of class <code>TD</code>.</p></td>
    </tr>
    <tr>
      <th>trials</th>
      <td><p>A character string specifying the trials to be analyzed. If
not supplied, all trials are used in the analysis.</p></td>
    </tr>
    <tr>
      <th>trait</th>
      <td><p>A character string specifying the trait to be analyzed.</p></td>
    </tr>
    <tr>
      <th>engine</th>
      <td><p>A character string specifying the engine used for modeling.
Either "lme4" or "asreml".</p></td>
    </tr>
    <tr>
      <th>criterion</th>
      <td><p>A string specifying a goodness-of-fit criterion. Either
"AIC" or "BIC".</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed to the modeling engine.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code><a href='varCov.html'>varCov</a></code>, a list object containing:</p>
<dt>STA</dt><dd><p>An object of class STA containing the best fitted model.</p></dd>
<dt>choice</dt><dd><p>A character string indicating the best fitted model.</p></dd>
<dt>summary</dt><dd><p>A data.frame with a summary of the fitted models.</p></dd>
<dt>vcov</dt><dd><p>The covariance matrix of the best fitted model.</p></dd>
<dt>criterion</dt><dd><p>A character string indicating the goodness-of-fit criterion
used for determining the best model, either "AIC" or "BIC".</p></dd>
<dt>engine</dt><dd><p>A character string containing the engine used for
the analysis.</p></dd>
<dt>trait</dt><dd><p>A character string containing the trait analyzed.</p></dd>
<dt>dat</dt><dd><p>A data.frame with the full data set used for the analysis.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The models fitted are of the form \(y_{ij} = \mu_j + \epsilon_{ij}\), where
\(y_{ij}\) is the phenotypic value of genotype \(i\) in environment
\(j\), \(\mu_j\)
is the environmental mean, and \(\epsilon_{ij}\) represents mainly genetic
variation, although some non-genetic variation may be included as well.
The random term \(\epsilon_{ij}\) is modeled in eight ways as described in
the table below.</p><table class='table'>
<tr><td>Model</td><td>Description</td><td>var(\(g_{ij}\))</td><td>cov(\(g_{ij}\);\(g_{ik}\))</td><td>Number of parameters</td></tr>
<tr><td>identity</td><td>identity</td><td>\(\sigma_G^2\)</td><td>0</td><td>1</td></tr>
<tr><td>cs</td><td>compound symmetry</td><td>\(\sigma_G^2 + \sigma_{GE}^2$ | $\sigma_{GE}^2\)</td><td>2</td><td></td></tr>
<tr><td>diagonal</td><td>diagonal matrix (heteroscedastic)</td><td>\(\sigma_{GE_j}^2\)</td><td>0</td><td>\(J\)</td></tr>
<tr><td>hcs</td><td>heterogeneous compound symmetry</td><td>\(\sigma_G^2+\sigma_{GE_j}^2\)</td><td>\(\sigma_G^2\)</td><td>\(J+1\)</td></tr>
<tr><td>outside</td><td>heterogeneity outside</td><td>\(\sigma_{G_j}^2\)</td><td>\(\theta\)</td><td>\(J+1\)</td></tr>
<tr><td>fa</td><td>first order factor analytic</td><td>\(\lambda_{1j}^2+\sigma_{GE_j}^2\)</td><td>\(\lambda_{1j}\lambda_{1k}\)</td><td>\(2J\)</td></tr>
<tr><td>fa2</td><td>second order factor analytic</td><td>\(\lambda_{1j}^2+\lambda_{2j}^2+\sigma_{GE_j}^2\)</td><td>\(\lambda_{1j}\lambda_{1k}+\lambda_{2j}\lambda_{2k}\)</td><td>\(3J-1\)</td></tr>
<tr><td>unstructured</td><td>unstructured</td><td>\(\sigma_{G_j}^2\)</td><td>\(\sigma_{G_{j,k}}^2\)</td><td>\(J(J+1)/2\)</td></tr>
</table>



<p>In this table \(J\) is the number of environments, \(\sigma_G^2\) the
variance component for the genotype main effects, \(\sigma_{GE}^2\) the
variance component for GxE interactions. \(\sigma_{G_j}^2\) and
\(\sigma_{GE_j}^2\) are the environment specific variance components for
the genotype main effects and GxE interaction in environment \(j\).
\(\sigma_{G_{j,k}}^2\) is the genetic covariance between environments
\(j\) and \(k\). \(\theta\) is the common correlation between
environments and \(\lambda_{1j}\) and \(\lambda_{2j}\) are
environment specific multiplicative parameters.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>If <code>engine = "lme4"</code>, only the compound symmetry model can be
fitted.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other varCov: 
<code><a href='fitted.varCov.html'>fitted.varCov</a>()</code>,
<code><a href='plot.varCov.html'>plot.varCov</a>()</code>,
<code><a href='report.varCov.html'>report.varCov</a>()</code>,
<code><a href='residuals.varCov.html'>residuals.varCov</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Select the best variance-covariance model using lme4 for modeling.</span>
<span class='va'>geVarCov</span> <span class='op'>&lt;-</span> <span class='fu'>gxeVarCov</span><span class='op'>(</span>TD <span class='op'>=</span> <span class='va'>TDMaize</span>, trait <span class='op'>=</span> <span class='st'>"yld"</span><span class='op'>)</span>

<span class='co'>## Summarize results.</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>geVarCov</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Best model: cs, based on BIC.
#&gt; </div><div class='output co'>#&gt;         AIC      BIC Deviance NParameters
#&gt; cs 21005.28 21016.14 21001.28           2</div><div class='input'>
<span class='co'># \donttest{</span>
<span class='co'>## Create a pdf report summarizing the results.</span>
<span class='fu'><a href='https://rdrr.io/pkg/statgenSTA/man/report.html'>report</a></span><span class='op'>(</span><span class='va'>geVarCov</span>, outfile <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span><span class='op'>(</span>fileext <span class='op'>=</span> <span class='st'>".pdf"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># }</span>

<span class='co'># \donttest{</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"asreml"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'>## Select the best variance-covariance model using asreml for modeling.</span>
  <span class='co'>## Use BIC as a goodness-of-fit criterion.</span>
  <span class='va'>geVarCov2</span> <span class='op'>&lt;-</span> <span class='fu'>gxeVarCov</span><span class='op'>(</span>TD <span class='op'>=</span> <span class='va'>TDMaize</span>, trait <span class='op'>=</span> <span class='st'>"yld"</span>, engine <span class='op'>=</span> <span class='st'>"asreml"</span>,
                         criterion <span class='op'>=</span> <span class='st'>"BIC"</span><span class='op'>)</span>

  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>geVarCov2</span><span class='op'>)</span>

  <span class='co'>## Plot a heatmap of the correlation matrix for the best model.</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>geVarCov2</span><span class='op'>)</span>
  <span class='op'>}</span>
</div><div class='output co'>#&gt; Best model: outside, based on BIC.
#&gt; </div><div class='img'><img src='gxeVarCov-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


