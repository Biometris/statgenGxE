<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Mixed model analysis of GxE table of means — gxeVarComp • statgenGxE</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Mixed model analysis of GxE table of means — gxeVarComp" />
<meta property="og:description" content="This function fits a mixed model best fitting to the data in a TD object.
The exact model fitted is determined by both the structure of the genotype by
environment table of observations and the chosen parameters.
Six different types of models can be fitted depending on the structure of
the environments in the data. These models are described in the table below,
together with the function parameters used in gxeVarComp to fit the model.
Structure of environmentsModelFunction parameters
Environments correspond to trialstrait = trial + genotype + genotype:trial
Trials form a factorial structure of locations x yearstrait = year + location + year:location + genotype + genotype:year + genotype:location + genotype:year:locationlocationYear = TRUE
Trials are nested within yeartrait = year + year:trial + genotype + genotype:year + genotype:year:trialnestingFactor = &quot;year&quot;
Trials are nested within locationstrait = location + location:trial + genotype + genotype:location + genotype:location:trialnestingFactor = &quot;loc&quot;
Trials correspond to locations within regions across yearstrait = region + region:location + year + region:year + region:location:year + genotype + genotype:region + genotype:region:location + genotype:year + genotype:region:year + genotype:region:location:yearregionLocationYear = TRUE
Trials are nested within scenariostrait = scenario + scenario:trial + genotype + genotype:scenario + genotype:scenario:trialnestingFactor = &quot;scenario&quot;




In the models above the random part of the model is printed bold.
For data in the form of GxE means, the last random term in all models above
will become a residual term. If the GxE means are provided together with
weights, then a residual term will be added to the models above.
The function first fits a model where all model terms are included as fixed
terms. Based on the ANOVA table of this model, terms in the fixed part of the
model that are likely to give a problem when fitting the mixed model are
removed because of the reduced connectivity and number of available
observations to estimate that model term. Also a warning is printed if the
mean sum of squares for a model term points to a possible zero variance
component in the mixed model.
Then a model is fitted where all model terms are included as random terms.
Based on the variance components in this model the percentage of variance
explained by each of the model components is determined. The percentages of
variance are printed in the model summary, together with the variance
components. The latter are presented on a standard deviation scale.
Finally a mixed model is fitted as specified in the overview above. Based on
this mixed model variance components can be computed using vc,
heritabilies can be computed using herit and predictions can be
made using predict.varComp. Predictions of genotypic
performance can be made at the level of individual trials, or for groups of
trials by using predictLevel." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statgenGxE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-seedling"></span>
     
    other packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    </li>
    <li>
      <a href="https://biometris.github.io/statgenGWAS">statgenGWAS</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/Biometris/statgenGxE">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mixed model analysis of GxE table of means</h1>
    
    <div class="hidden name"><code>gxeVarComp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function fits a mixed model best fitting to the data in a TD object.
The exact model fitted is determined by both the structure of the genotype by
environment table of observations and the chosen parameters.<br /><br />
Six different types of models can be fitted depending on the structure of
the environments in the data. These models are described in the table below,
together with the function parameters used in <code>gxeVarComp</code> to fit the model.</p><table class='table'>
<tr><td>Structure of environments</td><td>Model</td><td>Function parameters</td></tr>
<tr><td>Environments correspond to trials</td><td><strong>trait</strong> = trial + <strong>genotype + genotype:trial</strong></td><td></td></tr>
<tr><td>Trials form a factorial structure of locations x years</td><td><strong>trait</strong> = year + location + year:location + <strong>genotype + genotype:year + genotype:location + genotype:year:location</strong></td><td><code>locationYear = TRUE</code></td></tr>
<tr><td>Trials are nested within year</td><td><strong>trait</strong> = year + year:trial + <strong>genotype + genotype:year + genotype:year:trial</strong></td><td><code>nestingFactor = "year"</code></td></tr>
<tr><td>Trials are nested within locations</td><td><strong>trait</strong> = location + location:trial + <strong>genotype + genotype:location + genotype:location:trial</strong></td><td><code>nestingFactor = "loc"</code></td></tr>
<tr><td>Trials correspond to locations within regions across years</td><td><strong>trait</strong> = region + region:location + year + region:year + region:location:year + <strong>genotype + genotype:region + genotype:region:location + genotype:year + genotype:region:year + genotype:region:location:year</strong></td><td><code>regionLocationYear = TRUE</code></td></tr>
<tr><td>Trials are nested within scenarios</td><td><strong>trait</strong> = scenario + scenario:trial + <strong>genotype + genotype:scenario + genotype:scenario:trial</strong></td><td><code>nestingFactor = "scenario"</code></td></tr>
</table>



<p>In the models above the random part of the model is printed bold.<br />
For data in the form of GxE means, the last random term in all models above
will become a residual term. If the GxE means are provided together with
weights, then a residual term will be added to the models above.<br /><br />
The function first fits a model where all model terms are included as fixed
terms. Based on the ANOVA table of this model, terms in the fixed part of the
model that are likely to give a problem when fitting the mixed model are
removed because of the reduced connectivity and number of available
observations to estimate that model term. Also a warning is printed if the
mean sum of squares for a model term points to a possible zero variance
component in the mixed model.<br /><br />
Then a model is fitted where all model terms are included as random terms.
Based on the variance components in this model the percentage of variance
explained by each of the model components is determined. The percentages of
variance are printed in the model summary, together with the variance
components. The latter are presented on a standard deviation scale.<br /><br />
Finally a mixed model is fitted as specified in the overview above. Based on
this mixed model variance components can be computed using <code><a href='vc.html'>vc</a></code>,
heritabilies can be computed using <code><a href='herit.html'>herit</a></code> and predictions can be
made using <code><a href='predict.varComp.html'>predict.varComp</a></code>. Predictions of genotypic
performance can be made at the level of individual trials, or for groups of
trials by using <code>predictLevel</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>gxeVarComp</span>(
  <span class='kw'>TD</span>,
  trials = <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='kw'>TD</span>),
  <span class='kw'>trait</span>,
  engine = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"lme4"</span>, <span class='st'>"asreml"</span>),
  locationYear = <span class='fl'>FALSE</span>,
  nestingFactor = <span class='kw'>NULL</span>,
  regionLocationYear = <span class='fl'>FALSE</span>,
  useWt = <span class='fl'>FALSE</span>,
  diagnostics = <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>TD</th>
      <td><p>An object of class <code>TD</code>.</p></td>
    </tr>
    <tr>
      <th>trials</th>
      <td><p>A character string specifying the trials to be analyzed. If
not supplied, all trials are used in the analysis.</p></td>
    </tr>
    <tr>
      <th>trait</th>
      <td><p>A character string specifying the trait to be analyzed.</p></td>
    </tr>
    <tr>
      <th>engine</th>
      <td><p>A character string specifying the engine used for modeling.
Either "lme4" or "asreml".</p></td>
    </tr>
    <tr>
      <th>locationYear</th>
      <td><p>Should a model be fitted assuming a factorial structure
of locations x years?</p></td>
    </tr>
    <tr>
      <th>nestingFactor</th>
      <td><p>A character string specifying a column in TD specifying
the nesting structure of the trials.</p></td>
    </tr>
    <tr>
      <th>regionLocationYear</th>
      <td><p>Should a model be fitted assuming locations within
regions across years?</p></td>
    </tr>
    <tr>
      <th>useWt</th>
      <td><p>Should the model be fitted using weights? Doing so requires a
column wt in the data. If <code>useWt = FALSE</code>, the default, and the data
contains no replicates, the last model term will be dropped and used as
homogeneous residual.</p></td>
    </tr>
    <tr>
      <th>diagnostics</th>
      <td><p>Should diagnostics on missing combinations of model
variables be printed?</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>varComp</code>, a list containing:</p>
<dt>fitMod</dt><dd><p>The fitted model.</p></dd>
<dt>modDat</dt><dd><p>A data.frame containing the data used when fitting the model.</p></dd>
<dt>nestingFactor</dt><dd><p>A name of the variable used as nesting variable in the
model.</p></dd>
<dt>useLocYear</dt><dd><p>A boolean specifying if a model containing location x year
interaction was fitted.</p></dd>
<dt>fullRandVC</dt><dd><p>A data.frame containing the variance components for the
fully random model.</p></dd>
<dt>aovFullMixedMod</dt><dd><p>A data.frame containing the ANOVA table for the fully
fixed model.</p></dd>
<dt>engine</dt><dd><p>The engine used for fitting the model.</p></dd>
<dt>diagTabs</dt><dd><p>A list of data.frame, one for each random model term,
containing the missing combinations in the data for that term.</p></dd>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other Mixed model analysis: 
<code><a href='CRDR.html'>CRDR</a>()</code>,
<code><a href='correlations.html'>correlations</a>()</code>,
<code><a href='diagnostics.html'>diagnostics</a>()</code>,
<code><a href='herit.html'>herit</a>()</code>,
<code><a href='plot.varComp.html'>plot.varComp</a>()</code>,
<code><a href='predict.varComp.html'>predict.varComp</a>()</code>,
<code><a href='vc.html'>vc</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Fit a mixed model.</span>
<span class='kw'>geVarComp</span> <span class='op'>&lt;-</span> <span class='fu'>gxeVarComp</span>(TD = <span class='kw'>TDMaize</span>, trait = <span class='st'>"yld"</span>)

<span class='co'>## Summarize results.</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>geVarComp</span>)
</div><div class='output co'>#&gt; Fitted model formula
#&gt; yld ~ trial + (1 | genotype) 
#&gt; 
#&gt; Sources of variation
#&gt;           component % variance expl.
#&gt; trial      86448.61          81.89 %
#&gt; genotype    6670.93           6.32 %
#&gt; residuals  12446.94          11.79 %
#&gt; 
#&gt; Analysis of Variance Table for fully fixed model
#&gt;             Df    Sum Sq  Mean Sq   F value    Pr(&gt;F)    
#&gt; trial        7 127771687 18253098 1466.4731 &lt; 2.2e-16 ***
#&gt; genotype   210  13821018    65814    5.2876 &lt; 2.2e-16 ***
#&gt; residuals 1470  18296997    12447                        
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</div><div class='input'>
<span class='co'>## Plot the standard deviations.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>geVarComp</span>)
</div><div class='img'><img src='gxeVarComp-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Generate predictions</span>
<span class='kw'>pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='kw'>geVarComp</span>, predictLevel = <span class='st'>"trial"</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='kw'>pred</span>)
</div><div class='output co'>#&gt;   genotype trial predictedValue
#&gt; 1     G001 HN96b       529.1555
#&gt; 2     G002 HN96b       508.8126
#&gt; 3     G003 HN96b       500.3794
#&gt; 4     G004 HN96b       375.9096
#&gt; 5     G005 HN96b       495.8588
#&gt; 6     G006 HN96b       454.9297</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


