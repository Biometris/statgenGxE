<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot function for class AMMI — plot.AMMI • statgenGxE</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot function for class AMMI — plot.AMMI" />
<meta property="og:description" content="Two types of biplot can be made. A plot of genotype and environment
means vs PC1 (AMMI1) or a biplot of genotypes and environment interaction
with PC1 and PC2 (AMMI2).
If the AMMI analysis was done by year, a separate plot will be made for
every year in the data. For some years the number of principal components
may be lower than the number specified on the secondary axis. If this is the
case this year is skipped when plotting. If this happens for all years the
function returns an error." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statgenGxE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-seedling"></span>
     
    other packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    </li>
    <li>
      <a href="https://biometris.github.io/statgenGWAS">statgenGWAS</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/Biometris/statgenGxE">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot function for class AMMI</h1>
    <small class="dont-index">Source: <a href='https://github.com/Biometris/statgenGxE/blob/master/R/createAMMI.R'><code>R/createAMMI.R</code></a></small>
    <div class="hidden name"><code>plot.AMMI.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Two types of biplot can be made. A plot of genotype and environment
means vs PC1 (AMMI1) or a biplot of genotypes and environment interaction
with PC1 and PC2 (AMMI2).<br /><br />
If the AMMI analysis was done by year, a separate plot will be made for
every year in the data. For some years the number of principal components
may be lower than the number specified on the secondary axis. If this is the
case this year is skipped when plotting. If this happens for all years the
function returns an error.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for AMMI</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>...</span>,
  plotType <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"AMMI1"</span>, <span class='st'>"AMMI2"</span>, <span class='st'>"GGE2"</span><span class='op'>)</span>,
  scale <span class='op'>=</span> <span class='fl'>1</span>,
  plotGeno <span class='op'>=</span> <span class='cn'>TRUE</span>,
  colorGenoBy <span class='op'>=</span> <span class='cn'>NULL</span>,
  colGeno <span class='op'>=</span> <span class='cn'>NULL</span>,
  sizeGeno <span class='op'>=</span> <span class='fl'>0</span>,
  plotConvHull <span class='op'>=</span> <span class='cn'>FALSE</span>,
  plotEnv <span class='op'>=</span> <span class='cn'>TRUE</span>,
  colorEnvBy <span class='op'>=</span> <span class='cn'>NULL</span>,
  colEnv <span class='op'>=</span> <span class='cn'>NULL</span>,
  sizeEnv <span class='op'>=</span> <span class='fl'>3</span>,
  envFactor <span class='op'>=</span> <span class='fl'>1</span>,
  primAxis <span class='op'>=</span> <span class='st'>"PC1"</span>,
  secAxis <span class='op'>=</span> <span class='st'>"PC2"</span>,
  title <span class='op'>=</span> <span class='cn'>NULL</span>,
  output <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object of class AMMI</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Not used.</p></td>
    </tr>
    <tr>
      <th>plotType</th>
      <td><p>A character string indicating which plot should be made.
Either "AMMI1" for an AMMI1 plot (genotype and
environment means vs PC1) or "AMMI2" for an AMMI2 biplot (genotypes and
environment interaction with PC1 and PC2) respectively. For results of a
GGE analysis only an GGE2 biplot can be made and plotType may be ignored.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>A numerical value. The variables are scaled by
<code>lambda ^ scale</code> and the observations by <code>lambda ^ (1 - scale)</code>
where <code>lambda</code> are the singular values computed by
<code><a href='https://rdrr.io/r/stats/princomp.html'>princomp</a></code> in <code><a href='gxeAmmi.html'>gxeAmmi</a></code>. Normally
<code>0 &lt;= scale &lt;= 1</code>, and a warning will be issued if the specified
scale is outside this range.</p></td>
    </tr>
    <tr>
      <th>plotGeno</th>
      <td><p>Should genotypes be plotted?</p></td>
    </tr>
    <tr>
      <th>colorGenoBy</th>
      <td><p>A character string indicating a column in the <code>TD</code>
used as input for the AMMI analysis by which the genotypes should be colored.
If <code>NULL</code> all genotypes will be colored in black.</p></td>
    </tr>
    <tr>
      <th>colGeno</th>
      <td><p>A character vector with plot colors for the genotypes. A
single color when <code>colorGenoBy = NULL</code>, a vector of colors otherwise.</p></td>
    </tr>
    <tr>
      <th>sizeGeno</th>
      <td><p>An numerical value indicating the text size for plotting the
genotypes. Use <code>sizeGeno = 0</code> for plotting genotypes as points instead
of using their names.</p></td>
    </tr>
    <tr>
      <th>plotConvHull</th>
      <td><p>Should a convex hull be plotted around the genotypes. If
<code>TRUE</code> a convex hull is plotted. For GGE2 biplots lines from the origin
of the plot perpendicular to the edges of the hull are added. Only valid for
AMMI2 and GGE2 biplots.</p></td>
    </tr>
    <tr>
      <th>plotEnv</th>
      <td><p>Should environments be plotted?</p></td>
    </tr>
    <tr>
      <th>colorEnvBy</th>
      <td><p>A character string indicating a column in the <code>TD</code>
used as input for the AMMI analysis by which the environments should be
colored. If <code>NULL</code> all genotypes will be colored in red.</p></td>
    </tr>
    <tr>
      <th>colEnv</th>
      <td><p>A character string with plot colors for the environments. A
single color when <code>colorEnvBy = NULL</code>, a vector of colors otherwise.</p></td>
    </tr>
    <tr>
      <th>sizeEnv</th>
      <td><p>An integer indicating the text size for plotting the
environments.</p></td>
    </tr>
    <tr>
      <th>envFactor</th>
      <td><p>A positive numerical value giving a factor by which to blow
up the environmental scores. Providing a value between 0 and 1 will
effectively blow up the genotypic scores.</p></td>
    </tr>
    <tr>
      <th>primAxis</th>
      <td><p>A character string indicating the principal component to be
plotted on the primary axis of the AMMI2 plot. Has to be given as
<code>"PCn"</code> where n is the number of the principal component.</p></td>
    </tr>
    <tr>
      <th>secAxis</th>
      <td><p>A character string indicating the principal component to be
plotted on the secondary axis of the AMMI2 plot. Has to be given as
<code>"PCn"</code> where n is the number of the principal component. n Has to
differ from <code>primAxis</code>.</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p>A character string used a title for the plot.</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>Should the plot be output to the current device? If
<code>FALSE</code> only a list of ggplot objects is invisibly returned.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A biplot depending on <code>plotType</code>. The ggplot object for the
biplot is returned invisibly.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other AMMI: 
<code><a href='fitted.AMMI.html'>fitted.AMMI</a>()</code>,
<code><a href='gxeAmmi.html'>gxeAmmi</a>()</code>,
<code><a href='report.AMMI.html'>report.AMMI</a>()</code>,
<code><a href='residuals.AMMI.html'>residuals.AMMI</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Run AMMI analysis.</span>
<span class='va'>geAmmi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='gxeAmmi.html'>gxeAmmi</a></span><span class='op'>(</span>TD <span class='op'>=</span> <span class='va'>TDMaize</span>, trait <span class='op'>=</span> <span class='st'>"yld"</span><span class='op'>)</span>

<span class='co'>## Create an AMMI1 biplot.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>geAmmi</span><span class='op'>)</span>
</div><div class='img'><img src='plot.AMMI-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Create an AMMI2 biplot.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>geAmmi</span>, plotType <span class='op'>=</span> <span class='st'>"AMMI2"</span><span class='op'>)</span>
</div><div class='img'><img src='plot.AMMI-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Run GGE analysis.#'</span>
<span class='va'>geGGE</span> <span class='op'>&lt;-</span> <span class='fu'><a href='gxeGGE.html'>gxeGGE</a></span><span class='op'>(</span>TD <span class='op'>=</span> <span class='va'>TDMaize</span>, trait <span class='op'>=</span> <span class='st'>"yld"</span><span class='op'>)</span>

<span class='co'>## Create an GGE2 biplot.</span>
<span class='co'>## Add a convex hull.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>geAmmi</span>, plotType <span class='op'>=</span> <span class='st'>"AMMI2"</span>, plotConvHull <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='plot.AMMI-3.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


